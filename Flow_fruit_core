local core = {}

local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

core.Speed = 350
core.FruitList = {"Rocket", "Spin", "Blade", "Spring", "Bomb", "Smoke", "Spike", "Flame", "Falcon", "Ice", "Sand", "Dark", "Diamond", "Light", "Rubber", "Barrier", "Ghost", "Magma", "Quake", "Buddha", "Love", "Spider", "Sound", "Phoenix", "Portal", "Rumble", "Pain", "Blizzard", "Gravity", "Mammoth", "T-Rex", "Dough", "Shadow", "Venom", "Control", "Spirit", "Leopard", "Kitsune", "Dragon", "Dragon (East)"}

function core.HopServer()
    local x = {}
    local success, result = pcall(function()
        return game:GetService("HttpService"):JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100")).data
    end)
    if success then
        for _, v in ipairs(result) do
            if v.playing < v.maxPlayers and v.id ~= game.JobId then
                table.insert(x, v.id)
            end
        end
        TeleportService:TeleportToPlaceInstance(game.PlaceId, x[math.random(1, #x)])
    end
end

function core.SmartTeleport(target)
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    
    local hrp = char.HumanoidRootPart
    local destination = target.CFrame

    -- Tenta 3x teleporte direto
    for i = 1, 3 do
        hrp.CFrame = destination
        task.wait(0.3)
        if (hrp.Position - destination.Position).Magnitude < 15 then return true end
    end

    -- Se falhar, usa Tween
    local dist = (hrp.Position - destination.Position).Magnitude
    local info = TweenInfo.new(dist / core.Speed, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(hrp, info, {CFrame = destination})
    tween:Play()
    tween.Completed:Wait()
end

return core
