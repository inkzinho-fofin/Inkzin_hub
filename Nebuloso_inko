local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local Settings = settings()

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- === CONFIGURA√á√ÉO DA INTERFACE (MENSAGENS R√ÅPIDAS) === --

-- Cria a ScreenGui para notifica√ß√µes
local notifGui = Instance.new("ScreenGui")
notifGui.Name = "QuickNotifyUI"
notifGui.ResetOnSpawn = false -- N√£o some se morrer
notifGui.Parent = player:WaitForChild("PlayerGui")

local function notify(text, color)
	-- Remove mensagem anterior se existir para n√£o acumular
	local oldFrame = notifGui:FindFirstChild("NotifyFrame")
	if oldFrame then oldFrame:Destroy() end

	-- Cria o Fundo da Mensagem (Frame)
	local frame = Instance.new("Frame")
	frame.Name = "NotifyFrame"
	frame.Size = UDim2.new(0, 300, 0, 35) -- Tamanho pequeno
	frame.Position = UDim2.new(0.5, -150, 1, -80) -- Centralizado em baixo
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderSizePixel = 0
	frame.BackgroundTransparency = 0.1
	frame.Parent = notifGui

	-- Arredondar cantos
	local uiCorner = Instance.new("UICorner")
	uiCorner.CornerRadius = UDim.new(0, 6)
	uiCorner.Parent = frame

	-- Bot√£o X (Esquerda)
	local closeBtn = Instance.new("TextButton")
	closeBtn.Size = UDim2.new(0, 35, 1, 0)
	closeBtn.Position = UDim2.new(0, 0, 0, 0)
	closeBtn.BackgroundTransparency = 1
	closeBtn.Text = "X"
	closeBtn.TextColor3 = Color3.fromRGB(255, 80, 80) -- Vermelho claro
	closeBtn.TextSize = 16
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.Parent = frame

	-- Texto da Mensagem
	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(1, -40, 1, 0)
	label.Position = UDim2.new(0, 40, 0, 0)
	label.BackgroundTransparency = 1
	label.Text = text
	label.TextColor3 = color or Color3.fromRGB(255, 255, 255)
	label.TextSize = 14
	label.Font = Enum.Font.Gotham
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Parent = frame

	-- Fun√ß√£o de fechar ao clicar no X
	closeBtn.MouseButton1Click:Connect(function()
		if frame then frame:Destroy() end
	end)

	-- Anima√ß√£o simples de entrada (Fade in + Slide Up)
	frame.Position = UDim2.new(0.5, -150, 1, -60)
	frame.BackgroundTransparency = 1
	label.TextTransparency = 1
	closeBtn.TextTransparency = 1

	local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	TweenService:Create(frame, tweenInfo, {Position = UDim2.new(0.5, -150, 1, -80), BackgroundTransparency = 0.1}):Play()
	TweenService:Create(label, tweenInfo, {TextTransparency = 0}):Play()
	TweenService:Create(closeBtn, tweenInfo, {TextTransparency = 0}):Play()

	-- Auto deletar ap√≥s 5 segundos se n√£o clicar
	task.delay(5, function()
		if frame and frame.Parent then
			-- Anima√ß√£o de sa√≠da
			TweenService:Create(frame, tweenInfo, {BackgroundTransparency = 1, Position = UDim2.new(0.5, -150, 1, -60)}):Play()
			TweenService:Create(label, tweenInfo, {TextTransparency = 1}):Play()
			TweenService:Create(closeBtn, tweenInfo, {TextTransparency = 1}):Play()
			task.wait(0.3)
			if frame then frame:Destroy() end
		end
	end)
end

-- === CONFIGURA√á√ïES DO SCRIPT === --

local colorCorrection = Lighting:FindFirstChild("WDayCorrection") or Instance.new("ColorCorrectionEffect", Lighting)
colorCorrection.Name = "WDayCorrection"
colorCorrection.Saturation = 0

local DEFAULT_FOG_START = Lighting.FogStart
local DEFAULT_FOG_END = Lighting.FogEnd
local DEFAULT_BRIGHTNESS = Lighting.Brightness
local DEFAULT_CLOCK = Lighting.ClockTime
local DEFAULT_AMBIENT = Lighting.Ambient
local DEFAULT_OUTDOOR = Lighting.OutdoorAmbient

local rfogActive = false

-- === FUN√á√ïES AUXILIARES === --

local function getTargets(arg)
	local targets = {}
	if not arg then return targets end
	arg = arg:lower()
	local allPlayers = Players:GetPlayers()

	if arg == "@e" or arg == "all" then
		return allPlayers
	elseif arg == "@r" then
		table.insert(targets, allPlayers[math.random(1, #allPlayers)])
	elseif arg == "@p" then
		local closest = nil
		local dist = math.huge
		for _, p in pairs(allPlayers) do
			if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				local d = (p.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
				if d < dist then
					dist = d
					closest = p
				end
			end
		end
		if closest then table.insert(targets, closest) end
	else
		for _, p in pairs(allPlayers) do
			if p.Name:lower():sub(1, #arg) == arg or p.DisplayName:lower():sub(1, #arg) == arg then
				table.insert(targets, p)
			end
		end
	end
	return targets
end

-- === LOOP PRINCIPAL (+Rfog) === --
RunService.RenderStepped:Connect(function()
	if rfogActive then
		Lighting.FogStart = 100000
		Lighting.FogEnd = 100000
		Lighting.Brightness = 2
		Lighting.ClockTime = 14
		Lighting.GlobalShadows = false
	end
end)

-- === PROCESSAMENTO DE COMANDOS === --

player.Chatted:Connect(function(msg)
	local args = msg:split(" ")
	local cmd = args[1]:lower()
	
	-- 1. HELP / AJUDA (.?)
	if cmd == ".?" then
		notify("Comandos: .rs, +foc, /wday, +rfog, +explode, *kick", Color3.fromRGB(255, 215, 0))
	
	-- 2. RESET (.rs)
	elseif cmd == ".rs" then
		rfogActive = false
		colorCorrection.Saturation = 0
		
		local tweenInfo = TweenInfo.new(1.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
		TweenService:Create(Lighting, tweenInfo, {
			FogStart = DEFAULT_FOG_START,
			FogEnd = DEFAULT_FOG_END,
			Brightness = DEFAULT_BRIGHTNESS,
			ClockTime = DEFAULT_CLOCK,
			Ambient = DEFAULT_AMBIENT,
			OutdoorAmbient = DEFAULT_OUTDOOR
		}):Play()
		
		notify("Sistema reiniciado com sucesso.", Color3.fromRGB(100, 255, 100))

	-- 3. REMOVE FOG (+Rfog)
	elseif cmd == "+rfog" then
		rfogActive = not rfogActive
		if rfogActive then
			notify("‚ö° Neblina Removida (Travada)", Color3.fromRGB(255, 255, 100))
		else
			notify("‚òÅÔ∏è Neblina Destravada", Color3.fromRGB(200, 200, 200))
			Lighting.GlobalShadows = true
		end

	-- 4. FOG CONTROL (+Foc)
	elseif cmd == "+foc" then
		local val = tonumber(args[2])
		if val then
			rfogActive = false 
			val = math.clamp(val, 1, 100)
			
			local speedTime = 5 - ((val / 100) * 4.5)
			local targetDist = val * 50 
			
			local info = TweenInfo.new(speedTime, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
			TweenService:Create(Lighting, info, {FogEnd = targetDist, FogStart = 0}):Play()
			
			notify("Fog: " .. val .. "% (Dist: " .. targetDist .. ")", Color3.white)
		end

	-- 5. SATURATION (/Wday)
	elseif cmd == "/wday" then
		local mode = args[2] and args[2]:lower() or ""
		
		if mode == "baixa" or mode == "baixo" then
			TweenService:Create(colorCorrection, TweenInfo.new(1), {Saturation = -1}):Play()
			notify("Satura√ß√£o: Baixa (P&B)", Color3.white)
			
		elseif mode == "media" or mode == "medio" or mode == "padr√£o" then
			TweenService:Create(colorCorrection, TweenInfo.new(1), {Saturation = 0}):Play()
			notify("Satura√ß√£o: Padr√£o", Color3.white)
			
		elseif mode == "alta" or mode == "alto" then
			TweenService:Create(colorCorrection, TweenInfo.new(1), {Saturation = 0.8}):Play()
			notify("Satura√ß√£o: Alta (V√≠vido)", Color3.white)
		else
			notify("Uso: /Wday <baixa, media, alta>", Color3.fromRGB(255, 100, 100))
		end

	-- 6. EXPLODE (+Explode)
	elseif cmd == "+explode" then
		local targets = getTargets(args[2])
		if #targets > 0 then
			for _, target in pairs(targets) do
				if target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
					local exp = Instance.new("Explosion")
					exp.Position = target.Character.HumanoidRootPart.Position
					exp.BlastRadius = 10
					exp.BlastPressure = 500000
					exp.Parent = workspace
					notify("üí• BOOM: " .. target.Name, Color3.fromRGB(255, 80, 80))
				end
			end
		else
			notify("Alvo n√£o encontrado.", Color3.fromRGB(255, 100, 100))
		end

	-- 7. KICK (*Kick)
	elseif cmd == "*kick" then
		local targetName = args[2]
		local targetList = getTargets(targetName)
		local kickMsg = "Voc√™ foi expulso do servidor por " .. player.Name .. "."
		
		if #targetList > 0 then
			for _, t in pairs(targetList) do
				pcall(function() t:Kick(kickMsg) end)
				notify("Kickando: " .. t.Name, Color3.fromRGB(255, 50, 50))
			end
		else
			notify("Jogador n√£o encontrado.", Color3.fromRGB(255, 100, 100))
		end
	end
end)

-- Notifica√ß√£o Inicial
notify("Script Carregado! Digite .?", Color3.fromRGB(100, 255, 100))
